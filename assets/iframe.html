<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
  </head>
  <body onload="pageDidLoad()">
    <!-- <script src="./server.js"></script> -->
    <script src="https://static.zdassets.com/zendesk_app_framework_sdk/2.0/zaf_sdk.min.js"></script>
    <script>
      async function pageDidLoad() {
        var client = ZAFClient.init();
        let externalUrl = "";
        try {
          const data = await client.get("ticket.id");
          let ticketId = data["ticket.id"];
          externalUrl = `https://dashing-churros-ab5aaa.netlify.app/?ticket_id=${ticketId}`;
          document
            .getElementById("sapConnectIframe")
            .setAttribute("src", externalUrl);
        } catch (err) {
          console.log("Something went wrong");
        }
        client.invoke("resize", { width: "100%", height: "600px" });
      }
    </script>
    <h2 class="u-semibold u-fs-xl">Zendesk test App</h2>
    <iframe id="sapConnectIframe" src="about:blank" title="SAPCONNECT"></iframe>
  </body>
</html>
